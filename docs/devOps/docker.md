# docker
## 目录

- [Docker概述](#Docker概述)
    - [Docker平台](#Docker平台)
    - [我可以将Docker用于什么](#我可以将Docker用于什么？)
    - [docker架构](#docker架构)
- [获取Docker](#获取Docker)
- [获取Docker](#获取Docker)
    - [Docker平台](#Docker平台)
    - [我可以将Docker用于什么](#我可以将Docker用于什么？)
    - [docker架构](#docker架构)


## 大纲
## 基础入门
### Docker概述
Docker是基于Go语言实现的开源容器项目。
Docker是一个用于开发，交付和运行应用程序的开放平台。
Docker使您能够将应用程序与基础架构分开，从而可以快速交付软件。
助Docker，您可以以与管理应用程序相同的方式来管理基础架构。通过利用Docker的快速交付，测试和部署代码的方法，您可以显着减少编写代码和在生产环境中运行代码之间的延迟。

#### Docker平台
Docker提供了在松散隔离的环境（称为容器）中打包和运行应用程序的功能。隔离和安全性使您可以在给定主机上同时运行多个容器。容器是轻量级的，包含运行该应用程序所需的所有内容，因此您无需依赖主机上当前安装的内容。您可以在工作时轻松共享容器，并确保与您共享的每个人都能以相同的方式获得相同的容器。

Docker提供了工具和平台来管理容器的生命周期：

- 使用容器开发应用程序及其支持组件。
- 容器成为分发和测试您的应用程序的单元。
- 准备就绪后，可以将应用程序作为容器或协调服务部署到生产环境中。无论您的生产环境是本地数据中心，云提供商还是两者的混合，其工作原理都相同。

#### 我可以将Docker用于什么？
快速，一致地交付您的应用程序

Docker通过允许开发人员使用提供您的应用程序和服务的本地容器在标准化环境中工作，从而简化了开发生命周期。容器非常适合进行持续集成和持续交付（CI / CD）工作流。

考虑以下示例方案：

- 您的开发人员在本地编写代码，并使用Docker容器与同事共享他们的工作。
- 他们使用Docker将其应用程序推送到测试环境中，并执行自动和手动测试。
- 当开发人员发现错误时，他们可以在开发环境中对其进行修复，然后将其重新部署到测试环境中以进行测试和验证。
- 测试完成后，将修补程序推送给生产环境就像将更新的映像推送到生产环境一样简单。
- 响应式部署和扩展

Docker的基于容器的平台允许高度可移植的工作负载。Docker容器可以在开发人员的本地笔记本电脑上，数据中心内的物理或虚拟机上，云提供商上或混合环境中运行。

Docker的可移植性和轻量级的特性还使您可以轻松地动态管理工作负载，并根据业务需求指示实时扩展或拆除应用程序和服务。

在相同的硬件上运行更多的工作负载

Docker轻巧快速。它为基于虚拟机管理程序的虚拟机提供了一种可行的，具有成本效益的替代方案，因此您可以利用更多的计算能力来实现业务目标。Docker非常适合高密度环境以及中小型部署，而您需要用更少的资源做更多的事情。

 **Docker与虚拟化**

虚拟化（virtualization）技术是一个通用的概念，在不同领域有不同的理解。在计算领域，一般指的是计算虚拟化（computing virtualization），或通常说的服务器虚拟化。

虚拟化的核心是对资源的抽象，目标往往是为了在同一个主机上同时运行多个系统或应用，从而提高系统资源的利用率，并且带来降低成本、方便管理和容错容灾等好处。

虚拟化：硬件的虚拟化和软件的虚拟化

软件虚拟化：应用虚拟化和平台虚拟化

平台虚拟化：【完全虚拟化:虚拟机模拟完整底层硬件环境和特权指令的执行过程，客户的操作系统无须进行修改。（例：VMware Workstation、VirtualBox）】

平台虚拟化：【硬件辅助虚拟化：利用硬件（主要是CPU）辅助支持（目前x86体系结构上可用的硬件辅助虚拟化技术包括Intel-VT和AMD-V）处理敏感指令来实现完全虚拟化的功能，客户操作系统无须修改。】

平台虚拟化：【部分虚拟化：只针对部分硬件资源进行虚拟化，客户操作系统需要进行修改。现在有些虚拟化技术的早期版本仅支持部分虚拟化；】

平台虚拟化：【超虚拟化：部分硬件接口以软件的形式提供给客户机操作系统，客户操作系统需要进行修改】

平台虚拟化：【操作系统级虚拟化。内核通过创建多个虚拟的操作系统实例（内核和库）来隔离不同的进程。容器相关技术即在这个范畴】

**Docker以及其他容器技术都属于操作系统虚拟化这个范畴**，操作系统虚拟化最大的特点就是不需要额外的supervisor支持。

![img.png](images/img.png)

传统方式是在硬件层面实现虚拟化，需要有额外的虚拟机管理应用和虚拟机操作系统层。Docker容器是在操作系统层面上实现虚拟化，直接复用本地主机的操作系统，因此更加轻量级。


#### docker架构
Docker使用客户端-服务器架构。Docker客户端与Docker守护进程进行对话，该守护进程完成了构建，运行和分发Docker容器的繁重工作。

Docker客户端和守护程序可以 在同一系统上运行，或者您可以将Docker客户端连接到远程Docker守护程序。

Docker客户端和守护程序在UNIX套接字或网络接口上使用REST API进行通信。

另一个Docker客户端是Docker Compose，它使您可以处理由一组容器组成的应用程序。

以访问Docker官网的Get Docker（https://www.docker.com/get-docker）页面，查看获取Docker的方式，以及Docker支持的平台类型

![img.png](images/dockerjiagou.png)

##### Docker守护程序

Docker守护程序（dockerd）侦听Docker API请求并管理Docker对象，例如图像，容器，网络和卷。守护程序还可以与其他守护程序通信以管理Docker服务。

##### Docker客户端

Docker客户端（docker）是许多Docker用户与Docker交互的主要方式。当您使用诸如之类的命令时docker run，客户端会将这些命令发送到dockerd，以执行这些命令。该docker命令使用Docker API。Docker客户端可以与多个守护程序通信。

##### Docker注册表

Docker注册表存储Docker镜像。Docker Hub是任何人都可以使用的公共注册表，并且默认情况下，Docker已配置为在Docker Hub上查找镜像。您甚至可以运行自己的私人注册表。

使用docker pull或docker run命令时，将从配置的注册表中提取所需的图像。使用该docker push命令时，会将映像推送到已配置的注册表。

##### Docker对象


使用Docker时，您正在创建和使用镜像，容器，网络，卷，插件和其他对象。

###### 镜像

**一个镜像是用于创建一个码头工人容器指令的只读模板**。通常，一个镜像基于另一个镜像，并进行一些其他自定义。例如，您可以基于该ubuntu 镜像构建镜像，但安装Apache Web服务器和您的应用程序，以及运行该应用程序所需的配置详细信息。

您可以创建自己的镜像，也可以仅使用其他人创建并在注册表中发布的镜像。**要构建自己的镜像，您可以 使用简单的语法创建一个Dockerfile**，以定义创建镜像并运行它所需的步骤。Dockerfile中的每条指令都会在镜像中创建一个层。

当您更改Dockerfile并重建镜像时，仅重建那些已更改的层。与其他虚拟化技术相比，这是使镜像如此轻巧，小型和快速的部分原因。

###### 容器

**容器是镜像的可运行实例**。**您可以使用Docker API或CLI创建，启动，停止，移动或删除容器**。您可以将容器连接到一个或多个网络，将存储连接到它，甚至根据其当前状态创建一个新镜像。

默认情况下，容器与其他容器及其主机之间的隔离程度相对较高。您可以控制容器的网络，存储或其他底层子系统与其他容器或与主机的隔离程度。

容器由其镜像在创建或启动时为其提供的任何配置选项定义。删除容器后，未存储在持久性存储中的状态更改将消失。

示例docker run命令
以下命令运行一个ubuntu容器，以交互方式附加到本地命令行会话，然后运行/bin/bash。

$ docker run -i -t ubuntu /bin/bash
当您运行此命令时，会发生以下情况（假设您使用的是默认注册表配置）：

如果您在ubuntu本地没有该映像，则Docker会将其从已配置的注册表中拉出，就像您已docker pull ubuntu手动运行一样。

Docker会创建一个新容器，就像您已docker container create 手动运行命令一样。

Docker将一个读写文件系统分配给容器，作为其最后一层。这允许运行中的容器在其本地文件系统中创建或修改文件和目录。

Docker创建了一个网络接口，将容器连接到默认网络，因为您没有指定任何网络选项。这包括为容器分配IP地址。默认情况下，容器可以使用主机的网络连接连接到外部网络。

Docker启动容器并执行/bin/bash。因为容器是交互式运行的，并且已附加到您的终端（由于-i和-t 标志），所以您可以在输出记录到终端时使用键盘提供输入。

当您键入exit以终止/bin/bash命令时，该容器将停止但不会被删除。您可以重新启动或删除它。
### 底层技术

Docker用Go编程语言编写，并利用Linux内核的多种功能来交付其功能。Docker使用一种称为的技术namespaces来提供称为容器的隔离工作区。运行容器时，Docker会为该容器创建一组 名称空间。

这些名称空间提供了一层隔离。容器的每个方面都在单独的名称空间中运行，并且对其的访问仅限于该名称空间。

### 获取Docker[https://docs.docker.com/engine/]
   